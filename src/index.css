:root {
  /* 기본값: Safe Area 없음 (웹) */
  --safe-area-inset-top: 0px;
  --safe-area-inset-bottom: 0px;
  --safe-area-inset-left: 0px;
  --safe-area-inset-right: 0px;
}

/* iOS: env() 정상. Android: 네이티브 주입 우선, env() 폴백 (Chromium 140+ env 동작, < 140 env=0) */
body.platform-ios {
  --safe-area-inset-top: env(safe-area-inset-top, 0px);
  --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-inset-left: env(safe-area-inset-left, 0px);
  --safe-area-inset-right: env(safe-area-inset-right, 0px);
}
body.platform-android {
  --safe-area-inset-top: var(--native-safe-area-inset-top, env(safe-area-inset-top, 24px));
  --safe-area-inset-bottom: var(--native-safe-area-inset-bottom, env(safe-area-inset-bottom, 48px));
  --safe-area-inset-left: var(--native-safe-area-inset-left, env(safe-area-inset-left, 0px));
  --safe-area-inset-right: var(--native-safe-area-inset-right, env(safe-area-inset-right, 0px));
}

body.platform-android {
  --sidebar-top-offset: 0px;
  /* setDecorFitsSystemWindows(true) 사용 시 viewport가 이미 상태바·네비바 사이 */
  --safe-viewport-height: 100vh;
}
body.platform-ios {
  --safe-viewport-height: 100vh;
}

body.platform-ios {
  --sidebar-top-offset: 0px;
}

body:not(.platform-android):not(.platform-ios) {
  --sidebar-top-offset: 0px;
}

/* 상단 헤더(플로팅 버튼·알림종 40px) 높이 + 여유. 모든 페이지 콘텐츠가 헤더 아래서 출발하도록 통일 */
@media (max-width: 768px) {
  html.platform-android,
  body.platform-android {
    --mobile-top-padding: 72px;
  }
  
  body.platform-ios {
    --mobile-top-padding: 72px;
  }
  
  body:not(.platform-android):not(.platform-ios) {
    --mobile-top-padding: 72px;
  }
}

@media (max-width: 480px) {
  html.platform-android,
  body.platform-android {
    --mobile-top-padding: 72px;
  }
  
  body.platform-ios {
    --mobile-top-padding: 72px;
  }
  
  body:not(.platform-android):not(.platform-ios) {
    --mobile-top-padding: 72px;
  }
}

body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  background-attachment: fixed;
}

code {
  font-family: source-code-pro, Menlo, Monaco, Consolas, 'Courier New',
    monospace;
}

* {
  box-sizing: border-box;
}

html, body {
  height: 100%;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  background-attachment: fixed;
}

/* ========== 네이티브: setDecorFitsSystemWindows(true)로 WebView가 상태바·네비바 사이에만 그려짐 ========== */
/* body 패딩 불필요 — viewport가 이미 safe area. data-safe-area-*는 웹/기타 폴백용 */

/* 키보드 노출 시 하단 여백 제거 */
body.platform-android.keyboard-visible .app-layout > *:last-child,
body.platform-ios.keyboard-visible .app-layout > *:last-child {
  padding-bottom: 0 !important;
}
body.platform-android.keyboard-visible .app-layout:has([data-safe-area-bottom]) > *:last-child,
body.platform-ios.keyboard-visible .app-layout:has([data-safe-area-bottom]) > *:last-child {
  padding-bottom: 0 !important;
}
/* app-layout 메인 영역: 모바일에서 헤더(플로팅 버튼·알림 40px) 아래 콘텐츠 출발 */
@media (max-width: 768px) {
  body.platform-ios .app-layout > *:last-child,
  body.platform-android .app-layout > *:last-child,
  body.platform-web .app-layout > *:last-child,
  body .app-layout > *:last-child {
    padding-top: var(--mobile-top-padding, 72px) !important;
    padding-bottom: 1.5rem !important;
  }
}
/* 하단 고정 배너/요소 있는 페이지: safe-area 중복 방지. 가위바위보 제외(배너 오버레이) */
body.platform-ios .app-layout:has([data-safe-area-bottom]):not(:has([data-rps-page])) > *:last-child,
body.platform-android .app-layout:has([data-safe-area-bottom]):not(:has([data-rps-page])) > *:last-child {
  padding-bottom: 4.5rem !important; /* 배너 높이(~50px) + 여유만, 네비바 inset 제외 */
}
/* 가위바위보: 배너 오버레이. 하단 패딩은 좌우와 동일하게 */
body .app-layout:has([data-rps-page]) > *:last-child,
body.platform-android .app-layout:has([data-rps-page]) > *:last-child,
body.platform-ios .app-layout:has([data-rps-page]) > *:last-child {
  padding-bottom: clamp(0.5rem, 1.5vw, 1rem) !important;
}
@media (max-width: 768px) {
  body .app-layout:has([data-rps-page]) > *:last-child,
  body.platform-android .app-layout:has([data-rps-page]) > *:last-child,
  body.platform-ios .app-layout:has([data-rps-page]) > *:last-child {
    padding-bottom: 0.75rem !important;
  }
}

body.modal-open {
  overflow: hidden;
}

#root {
  height: 100%;
  background: transparent;
}

/* 네이티브: 상단/하단 시스템바 영역 침범 방지 — 전역 한 방 적용 */
body.platform-android .app-safe-area-wrap,
body.platform-ios .app-safe-area-wrap {
  min-height: var(--safe-viewport-height, 100vh) !important;
  max-height: var(--safe-viewport-height, 100vh) !important;
  overflow-y: auto !important;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
}
body.platform-android .app-layout,
body.platform-ios .app-layout {
  min-height: var(--safe-viewport-height, 100vh) !important;
  max-height: var(--safe-viewport-height, 100vh) !important;
}
/* 가위바위보 페이지: 스크롤 없이 뷰포트 100% 차지 */
body .app-safe-area-wrap:has([data-rps-page]),
body.platform-android .app-safe-area-wrap:has([data-rps-page]),
body.platform-ios .app-safe-area-wrap:has([data-rps-page]) {
  overflow: hidden !important;
  min-height: 100dvh !important;
  max-height: 100dvh !important;
}

/* 모바일 터치 이벤트 최적화 */
* {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  touch-action: manipulation;
}

/* 텍스트 입력 필드는 선택 가능하도록 */
input, textarea, [contenteditable] {
  -webkit-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;
  user-select: text;
}

/* 토스트 컨테이너 — setDecorFitsSystemWindows(true)로 viewport가 상태바 아래이므로 기본 top: 1em으로 충분 */
.Toastify__toast-container {
  touch-action: manipulation;
}

.Toastify__toast {
  touch-action: manipulation;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
}

/* 스크롤 영역 터치 최적화 */
.scrollable-content {
  -webkit-overflow-scrolling: touch;
}

/* 메인 알림종: 모바일에서만 fixed 상단 고정 (데스크톱은 플로우 유지) */
@media (max-width: 768px) {
  .main-notification-bell-fixed {
    position: fixed !important;
    top: 16px !important;
    right: 20px !important;
    z-index: 1000 !important;
  }
}
@media (min-width: 769px) {
  .main-notification-bell-fixed {
    position: relative !important;
    top: auto !important;
    right: auto !important;
  }
  .main-notification-bell-spacer {
    display: none !important;
  }
} 