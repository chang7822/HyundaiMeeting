# 📱 웹뷰 앱 업데이트 가이드

## 🎯 핵심 원칙

**웹뷰 앱은 웹사이트만 변경하는 경우 앱 업데이트가 필요 없습니다!**

---

## ✅ 앱 업데이트가 **필요 없는** 경우

### 1. 웹사이트 코드 변경
- React 컴포넌트 수정
- UI/UX 변경
- API 호출 로직 변경
- 상태 관리 로직 변경
- CSS/스타일 변경
- **→ 그냥 웹사이트만 배포하면 됨!**

### 2. 백엔드 서버 변경
- API 엔드포인트 수정
- 데이터베이스 스키마 변경
- 서버 로직 변경
- **→ 웹사이트 배포만 하면 됨!**

### 3. 웹사이트 설정 변경
- 환경 변수 변경
- API URL 변경
- **→ 웹사이트 배포만 하면 됨!**

---

## ❌ 앱 업데이트가 **필요한** 경우

### 1. Capacitor 플러그인 추가/변경/업데이트
**예시:**
- 새로운 네이티브 기능 추가 (카메라, 파일 시스템 등)
- 기존 플러그인 업데이트
- 플러그인 설정 변경

**현재 사용 중인 플러그인:**
- `@capacitor/push-notifications` - 푸시 알림
- `@capacitor-community/admob` - 광고
- `@capacitor/status-bar` - 상태바

**업데이트 절차:**
```bash
# 1. 플러그인 설치/업데이트
npm install @capacitor/새플러그인

# 2. Capacitor 동기화
npx cap sync android

# 3. 버전 코드 증가 (android/app/build.gradle)
versionCode 2  # 1에서 2로 증가
versionName "1.1"  # 사용자에게 보이는 버전

# 4. 웹 빌드
npm run build

# 5. AAB 빌드
cd android
./gradlew bundleRelease

# 6. Google Play Console에 업로드
```

### 2. 앱 메타데이터 변경
**예시:**
- 앱 이름 변경 (`appName` in `capacitor.config.ts`)
- 앱 아이콘 변경
- 앱 패키지 ID 변경 (`appId`)
- 앱 권한 추가/변경 (AndroidManifest.xml)

**업데이트 절차:**
```bash
# 1. capacitor.config.ts 수정
# 2. 버전 코드 증가
# 3. npm run build
# 4. npx cap sync android
# 5. ./gradlew bundleRelease
```

### 3. Android 네이티브 설정 변경
**예시:**
- `build.gradle` 설정 변경 (minSdkVersion, targetSdkVersion 등)
- AndroidManifest.xml 권한 추가
- 네이티브 코드 수정 (Java/Kotlin)
- ProGuard 설정 변경

**업데이트 절차:**
```bash
# 1. 네이티브 설정 수정
# 2. 버전 코드 증가
# 3. npm run build
# 4. npx cap sync android
# 5. ./gradlew bundleRelease
```

### 4. Capacitor 버전 업그레이드
**예시:**
- `@capacitor/core` 업그레이드
- `@capacitor/android` 업그레이드
- Capacitor 설정 변경

**업데이트 절차:**
```bash
# 1. Capacitor 업그레이드
npm install @capacitor/core@latest @capacitor/android@latest

# 2. Capacitor 업데이트
npx cap update android

# 3. 버전 코드 증가
# 4. npm run build
# 5. npx cap sync android
# 6. ./gradlew bundleRelease
```

### 5. 앱 버전 정보 변경
**예시:**
- 버전 코드 증가 (Google Play Store 필수)
- 버전 이름 변경

**업데이트 절차:**
```bash
# 1. android/app/build.gradle 수정
versionCode 2  # 반드시 증가해야 함
versionName "1.1"

# 2. npm run build
# 3. npx cap sync android
# 4. ./gradlew bundleRelease
```

---

## 🔄 일반적인 업데이트 워크플로우

### 시나리오 1: 웹사이트만 변경 (가장 흔한 경우)
```bash
# 1. 코드 수정
# 2. 웹사이트 배포
npm run build
# 3. 서버에 배포 (예: Vercel, Netlify, AWS 등)
# 끝! 앱 업데이트 불필요
```

### 시나리오 2: 네이티브 기능 추가
```bash
# 1. 플러그인 설치
npm install @capacitor/camera

# 2. capacitor.config.ts에 플러그인 추가 (필요시)

# 3. 버전 코드 증가
# android/app/build.gradle에서:
versionCode 2
versionName "1.1"

# 4. 웹 빌드
npm run build

# 5. Capacitor 동기화
npx cap sync android

# 6. AAB 빌드
cd android
./gradlew bundleRelease

# 7. Google Play Console에 업로드
```

---

## 📋 체크리스트: 앱 업데이트가 필요한가?

다음 중 하나라도 해당되면 **앱 업데이트 필요**:
- [ ] 새로운 Capacitor 플러그인 추가
- [ ] 기존 Capacitor 플러그인 업데이트
- [ ] 앱 이름 변경
- [ ] 앱 아이콘 변경
- [ ] 앱 권한 추가/변경
- [ ] Android 네이티브 코드 수정
- [ ] build.gradle 설정 변경
- [ ] Capacitor 버전 업그레이드
- [ ] 버전 코드 증가 (Google Play Store 필수)

다음은 **앱 업데이트 불필요**:
- [ ] React 컴포넌트 수정
- [ ] UI/UX 변경
- [ ] API 호출 로직 변경
- [ ] 백엔드 서버 변경
- [ ] CSS/스타일 변경
- [ ] 환경 변수 변경

---

## 🚀 앱 업데이트 절차 (전체)

### 1단계: 버전 정보 업데이트
`android/app/build.gradle` 파일 수정:
```gradle
defaultConfig {
    versionCode 2  // 이전보다 큰 숫자 (필수!)
    versionName "1.1"  // 사용자에게 보이는 버전
}
```

### 2단계: 웹 빌드
```bash
npm run build
```

### 3단계: Capacitor 동기화
```bash
npx cap sync android
```

### 4단계: AAB 빌드
```bash
cd android
./gradlew bundleRelease
```

### 5단계: Google Play Console 업로드
1. https://play.google.com/console 접속
2. 앱 선택
3. "프로덕션" 또는 "내부 테스트" 선택
4. "새 버전 만들기" 클릭
5. `android/app/build/outputs/bundle/release/app-release.aab` 업로드
6. 릴리스 노트 작성
7. 검토 후 출시

---

## ⚠️ 중요 주의사항

### 버전 코드 (versionCode)
- **반드시 이전 버전보다 큰 숫자여야 함**
- Google Play Store가 업데이트를 인식하는 기준
- 예: 1 → 2 → 3 → 4...

### 버전 이름 (versionName)
- 사용자에게 보이는 버전
- 형식 자유 (예: "1.0", "1.1", "2.0.0")
- 버전 코드와 달리 자유롭게 변경 가능

### 서명 키
- **절대 변경하면 안 됨!**
- 같은 서명 키로 계속 업데이트해야 함
- `android/app/release-key.jks` 파일 보관 필수

---

## 💡 실전 예시

### 예시 1: 메인 페이지 UI 변경
```
❌ 앱 업데이트 불필요
→ 웹사이트만 배포하면 됨
```

### 예시 2: 푸시 알림 기능 추가
```
✅ 앱 업데이트 필요
→ @capacitor/push-notifications 플러그인 사용 중이므로
→ 버전 코드 증가 → 빌드 → 업로드
```

### 예시 3: 새로운 API 엔드포인트 추가
```
❌ 앱 업데이트 불필요
→ 웹사이트만 배포하면 됨
```

### 예시 4: 앱 아이콘 변경
```
✅ 앱 업데이트 필요
→ 네이티브 리소스 변경
→ 버전 코드 증가 → 빌드 → 업로드
```

---

## 📊 요약

| 변경 사항 | 앱 업데이트 필요? |
|---------|----------------|
| 웹사이트 코드 변경 | ❌ 불필요 |
| UI/UX 변경 | ❌ 불필요 |
| API 로직 변경 | ❌ 불필요 |
| 백엔드 변경 | ❌ 불필요 |
| Capacitor 플러그인 추가 | ✅ 필요 |
| 앱 이름/아이콘 변경 | ✅ 필요 |
| 앱 권한 추가 | ✅ 필요 |
| 네이티브 코드 변경 | ✅ 필요 |
| Capacitor 업그레이드 | ✅ 필요 |

**결론: 웹뷰 앱은 대부분의 경우 웹사이트만 업데이트하면 되고, 네이티브 기능을 변경할 때만 앱 업데이트가 필요합니다!**

